
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Novetech • Monitoramento de Lotes (e-SUS PEC) v3.1</title>
  <meta name="description" content="Painel de monitoramento de lotes com detalhamento por unidades e KPIs contextuais — Novetech" />
  <style>
    :root{
      --bg: #0b1020;
      --panel: rgba(255,255,255,0.06);
      --panel-2: rgba(255,255,255,0.08);
      --accent: #38b6ff;
      --accent-2: #5eead4;
      --text: #e6f1ff;
      --muted: #a3b3c2;
      --good: #16a34a;
      --warn: #f59e0b;
      --bad: #ef4444;
      --border: rgba(255,255,255,0.08);
      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --shadow-soft: 0 6px 20px rgba(0,0,0,.25);
      --radius: 14px;
      --radius-sm: 10px;
    }
    *{ box-sizing: border-box }
    html, body{ height: 100% }
    body{
      margin: 0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", "Noto Sans";
      background: radial-gradient(1200px 600px at 10% -20%, rgba(56,182,255,.15), transparent),
                  radial-gradient(1000px 700px at 90% 0%, rgba(94,234,212,.15), transparent),
                  var(--bg);
      color: var(--text);
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a{ color: var(--accent) }
    .container{ width: min(1200px, 92vw); margin: 28px auto 60px; }
    header{ display: flex; align-items: center; justify-content: space-between; gap: 16px; margin-bottom: 22px; }
    .brand{ display: flex; align-items: center; gap: 14px; }
    .logo{ width:42px; height:42px; border-radius:10px; background:linear-gradient(135deg, var(--accent), var(--accent-2)); box-shadow: var(--shadow-soft); position:relative }
    .logo:after{ content:"N"; position:absolute; inset:0; display:grid; place-items:center; color:#0b1020; font-weight:800; font-size:22px; text-shadow:0 1px 0 rgba(255,255,255,.3) }
    .titles h1{ margin:0; font-size:clamp(18px, 2.6vw, 24px); letter-spacing:.2px }
    .titles .sub{ font-size:12px; color:var(--muted); margin-top:4px }
    .actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end }
    button, .btn{
      appearance:none; border:0; border-radius:12px;
      background: linear-gradient(180deg, var(--panel-2), rgba(255,255,255,0.03));
      color: var(--text); padding:10px 14px; cursor:pointer;
      display:inline-flex; align-items:center; gap:10px;
      box-shadow: var(--shadow-soft); border:1px solid var(--border);
      transition: transform .05s ease, background .2s ease, border-color .2s ease;
      font-weight:600; font-size:14px;
    }
    button:hover{ border-color: rgba(255,255,255,.16) }
    button:active{ transform: translateY(1px) }
    .btn-primary{ background: linear-gradient(135deg, rgba(56,182,255,.22), rgba(94,234,212,.16)); border: 1px solid rgba(56,182,255,.35); }
    .hidden-input{ position:absolute; width:1px; height:1px; overflow:hidden; clip: rect(0,0,0,0); }
    .grid{ display:grid; gap:16px }
    .grid.cards{ grid-template-columns: repeat(5, minmax(0, 1fr)) }
    @media (max-width:1200px){ .grid.cards{ grid-template-columns: repeat(3, minmax(0, 1fr)) } }
    @media (max-width:680px){ .grid.cards{ grid-template-columns: 1fr } }
    .card{
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.02));
      border:1px solid var(--border); border-radius: var(--radius);
      padding:16px; box-shadow: var(--shadow); backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
    }
    .kpi{ display:grid; grid-template-columns:auto 1fr; gap:6px 12px; align-items:center }
    .kpi .label{ font-size:12px; color:var(--muted) }
    .kpi .value{ font-weight:800; font-size:22px }
    .kpi .trend{ font-size:12px; color:var(--muted) }
    .progress{ height:8px; background: rgba(255,255,255,.07); border-radius:999px; overflow:hidden; margin-top:10px; border:1px solid var(--border) }
    .progress > i{ display:block; height:100%; width:0%; background: linear-gradient(90deg, var(--accent), var(--accent-2)) }
    .filters{ display:grid; grid-template-columns: 1fr 180px 180px 150px 140px; gap:12px; align-items:end }
    @media (max-width:980px){ .filters{ grid-template-columns: 1fr 1fr } }
    label{ font-size:12px; color:var(--muted); display:block; margin-bottom:6px }
    input[type="text"], select{
      width:100%; background: rgba(255,255,255,.04); color:var(--text);
      border:1px solid var(--border); border-radius:12px; padding:10px 12px; outline:none;
      transition:border-color .2s ease, background .2s ease; box-shadow: inset 0 1px 0 rgba(255,255,255,.03);
    }
    input[type="text"]:focus, select:focus{ border-color: rgba(56,182,255,.45); background: rgba(255,255,255,.06) }
    .table-wrap{ margin-top:16px; background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.02)); border:1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); overflow:hidden; }
    table{ width:100%; border-collapse: collapse; font-size:14px }
    thead th{
      text-align:left; font-weight:700; letter-spacing:.2px; font-size:12px; color:var(--muted);
      background: rgba(255,255,255,.03); position: sticky; top: 0; z-index: 2;
      border-bottom: 1px solid var(--border); padding: 12px 14px; user-select: none; cursor: pointer;
    }
    tbody td{ padding: 14px; border-bottom: 1px solid var(--border); vertical-align: middle; }
    tbody tr:hover{ background: rgba(255,255,255,.02) }
    .status{ display:inline-flex; align-items:center; gap:10px; font-weight:700; padding: 6px 10px; border-radius:999px; font-size:12px; border:1px solid var(--border) }
    .dot{ width: 10px; height: 10px; border-radius: 999px; display:inline-block }
    .ok{ color:#a7f3d0 } .ok .dot{ background: var(--good) }
    .alerta{ color:#fde68a } .alerta .dot{ background: var(--warn) }
    .critico{ color:#fecaca } .critico .dot{ background: var(--bad) }
    .hint{ font-size:12px; color:var(--muted); margin-top:8px }
    .footer{ margin-top:18px; font-size:12px; color:var(--muted); text-align:right }
    .nowrap{ white-space: nowrap }
    .right{ text-align: right }
    .mono{ font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono" }
    .sr-only{ position: absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0 }

    /* Drilldown */
    .row-toggle{ display:inline-flex; align-items:center; gap:10px }
    .caret{
      width: 18px; height: 18px; border-radius: 6px; border:1px solid var(--border);
      display:inline-grid; place-items:center; background: rgba(255,255,255,.03);
      transform: rotate(-90deg); transition: transform .18s ease, background .2s ease, border-color .2s ease;
    }
    tr.expanded .caret{ transform: rotate(0deg); background: rgba(56,182,255,.14); border-color: rgba(56,182,255,.35) }
    tr.details td{ background: rgba(255,255,255,.03); padding: 0 0 14px 0 }
    .units{
      margin: 0 14px 14px; border: 1px dashed var(--border); border-radius: 12px; overflow:hidden;
    }
    .units header{
      display:flex; align-items:center; justify-content:space-between; padding: 10px 12px;
      border-bottom: 1px dashed var(--border); margin: 0;
    }
    .units table thead th{ background: rgba(255,255,255,.02); font-size: 11px }
    .badge{
      display:inline-flex; gap:8px; padding:6px 10px; border-radius:999px; border:1px solid var(--border);
      background: rgba(255,255,255,.03); font-size:12px; color:var(--muted);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="titles">
          <h1>Novetech • Monitoramento de Lotes (e‑SUS PEC) — KPIs por Filtro</h1>
          <div class="sub">KPIs e tabela refletem a cidade/versão/status/termo selecionados • <span id="clock">--:--</span></div>
        </div>
      </div>
      <div class="actions">
        <label class="btn btn-primary" for="csvFile">
          <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M19 12h-4V3H9v9H5l7 7l7-7zM5 19v2h14v-2H5z"/></svg>
          Importar CSV
        </label>
        <input id="csvFile" class="hidden-input" type="file" accept=".csv,.txt" />
        <button id="exportCsvBtn" class="btn" title="Exportar CSV">
          <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M5 20h14v-2H5v2Zm7-3l5-5h-3V4h-4v8H7l5 5Z"/></svg>
          Exportar CSV
        </button>
        <button id="resetBtn" class="btn" title="Limpar e restaurar exemplo">
          <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 6V3L8 7l4 4V8c2.8 0 5 2.2 5 5c0 1.5-.7 2.9-1.7 3.8l1.4 1.4C18.3 17 19 15.6 19 14c0-3.9-3.1-7-7-7Zm-5.7.2L4.9 7.6C3.7 9 3 10.5 3 12c0 3.9 3.1 7 7 7v3l4-4l-4-4v3c-2.8 0-5-2.2-5-5c0-1.5.7-2.9 1.7-3.8Z"/></svg>
          Resetar
        </button>
      </div>
    </header>

    <section class="grid cards" aria-label="Indicadores">
      <div class="card kpi" id="kpi-cidades" aria-live="polite">
        <div class="badge">Cidades</div>
        <div class="value mono" data-kpi="cidades">0</div>
        <div class="label">No recorte atual</div>
      </div>
      <div class="card kpi" id="kpi-unidades" aria-live="polite">
        <div class="badge">Unidades</div>
        <div class="value mono" data-kpi="unidades">0</div>
        <div class="label">No recorte atual</div>
      </div>
      <div class="card kpi" id="kpi-atendente">
        <div class="badge">Atendente</div>
        <div class="value mono" data-kpi="atendente">0</div>
        <div class="label">Importado p/ Atendente de Saúde</div>
        <div class="progress"><i id="prog-atendente"></i></div>
      </div>
      <div class="card kpi" id="kpi-pec">
        <div class="badge">PEC</div>
        <div class="value mono" data-kpi="pec">0</div>
        <div class="label">Importado p/ o PEC</div>
        <div class="progress"><i id="prog-pec"></i></div>
      </div>
      <div class="card kpi" id="kpi-invalidas">
        <div class="badge">Qualidade</div>
        <div class="value mono" data-kpi="invalidas">0</div>
        <div class="label">Fichas inválidas</div>
        <div class="trend" id="kpi-taxa">Taxa inválidas: —</div>
      </div>
    </section>

    <div class="card" style="margin-top:16px">
      <div class="filters">
        <div>
          <label for="search">Busca rápida</label>
          <input id="search" type="text" placeholder="Buscar por cidade, unidade, nº PEC ou versão..." />
        </div>
        <div>
          <label for="cidadeSel">Cidade</label>
          <select id="cidadeSel">
            <option value="">Todas</option>
          </select>
        </div>
        <div>
          <label for="versaoSel">Versão do PEC</label>
          <select id="versaoSel">
            <option value="">Todas</option>
          </select>
        </div>
        <div>
          <label for="statusSel">Status</label>
          <select id="statusSel">
            <option value="">Todos</option>
            <option value="OK">OK</option>
            <option value="Alerta">Alerta</option>
            <option value="Crítico">Crítico</option>
          </select>
        </div>
        <div>
          <label for="limiteSel">Exibir</label>
          <select id="limiteSel">
            <option value="1000">Todos</option>
            <option value="50">50</option>
            <option value="100" selected>100</option>
            <option value="200">200</option>
          </select>
        </div>
      </div>
      <div class="hint">
        Os **KPIs** lá em cima refletem o **recorte atual** (ex.: cidade selecionada). Importe CSV de <strong>unidades</strong> (<code class="mono">cidade,unidade,numero_pec_atual,versao_pec_atual,importado_atendente,importado_pec,fichas_invalidas</code>) ou o formato antigo (apenas cidade).
      </div>
    </div>

    <div class="table-wrap" role="region" aria-label="Tabela de lotes por cidade">
      <table id="lotesTable" aria-describedby="legend">
        <thead>
          <tr>
            <th data-key="cidade" aria-sort="none">Cidade</th>
            <th data-key="numeroPEC" class="nowrap" aria-sort="none">Nº do PEC atual</th>
            <th data-key="versaoPEC" aria-sort="none">Versão atual do PEC</th>
            <th data-key="importadoAtendente" class="right nowrap" aria-sort="none">Importado p/ Atendente</th>
            <th data-key="importadoPEC" class="right nowrap" aria-sort="none">Importado p/ PEC</th>
            <th data-key="invalidas" class="right nowrap" aria-sort="none">Fichas inválidas</th>
            <th data-key="status" aria-sort="none">Status</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

    <div id="legend" class="footer">
      Novetech • Clique na linha da <strong>cidade</strong> para expandir as <strong>unidades</strong> • <span id="foot-count">0</span> cidades exibidas
    </div>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const $$ = sel => [...document.querySelectorAll(sel)];

  // ---------- Estado ----------
  let datasetUnidades = [];
  let cidadesAgg = [];
  let filtered = [];
  let expanded = new Set();
  let sortState = { key: "cidade", dir: "asc" };

  const dom = {
    clock: $("#clock"),
    tbody: $("#tbody"),
    cidadeSel: $("#cidadeSel"),
    versaoSel: $("#versaoSel"),
    statusSel: $("#statusSel"),
    limiteSel: $("#limiteSel"),
    search: $("#search"),
    exportCsvBtn: $("#exportCsvBtn"),
    resetBtn: $("#resetBtn"),
    file: $("#csvFile"),
    kpiCidades: document.querySelector('[data-kpi="cidades"]'),
    kpiUnidades: document.querySelector('[data-kpi="unidades"]'),
    kpiAtendente: document.querySelector('[data-kpi="atendente"]'),
    kpiPec: document.querySelector('[data-kpi="pec"]'),
    kpiInvalidas: document.querySelector('[data-kpi="invalidas"]'),
    progAt: $("#prog-atendente"),
    progPec: $("#prog-pec"),
    kpiTaxa: $("#kpi-taxa"),
    footCount: $("#foot-count")
  };

  // ---------- Util ----------
  function onlyCityName(s){
    const str = (s || "").toString().trim();
    const m = str.match(/^(.+?)(?:\s*\/\s*[A-Za-z]{2})?$/);
    return m ? m[1].trim() : str;
  }
  const normalize = s => (s || "").toString().toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
    .replace(/[^a-z0-9]+/g, "");
  function toInt(v){
    if (typeof v === "number") return Math.round(v);
    if (v == null) return 0;
    const cleaned = String(v).replace(/\./g,"").replace(",", ".").replace(/[^\d\.-]/g,"");
    const n = parseFloat(cleaned);
    return Number.isFinite(n) ? Math.round(n) : 0;
  }
  function detectDelimiter(text){
    const first = text.split(/\r?\n/)[0] || "";
    const cands = [",",";","\\t","|"];
    let best = ","; let max = -1;
    for (const d of cands){
      const re = d === "\\t" ? /\t/g : new RegExp("\\" + d, "g");
      const cnt = (first.match(re) || []).length;
      if (cnt > max){ max = cnt; best = (d === "\\t" ? "\t" : d); }
    }
    return best;
  }
  function parseCSV(text){
    const delim = detectDelimiter(text);
    const rows = [];
    let cur = [], field = "", i = 0, inQuotes = false;
    while (i < text.length){
      const c = text[i++];
      if (inQuotes){
        if (c === '"'){
          if (text[i] === '"'){ field += '"'; i++; }
          else inQuotes = false;
        } else field += c;
      } else {
        if (c === '"') inQuotes = true;
        else if (c === delim){ cur.push(field); field = ""; }
        else if (c === "\n" || c === "\r"){
          if (c === "\r" && text[i] === "\n") i++;
          cur.push(field); rows.push(cur); cur = []; field = "";
        } else field += c;
      }
    }
    if (field.length || cur.length){ cur.push(field); rows.push(cur); }
    return rows.filter(r => r.length && r.some(x => (x||"").trim() !== ""));
  }
  function computeStatus(row){
    const at = row.importadoAtendente || 0;
    const pec = row.importadoPEC || 0;
    const inv = row.invalidas || 0;
    const taxaInv = at > 0 ? inv / at : 0;
    const gap = at > 0 ? Math.max(0, (at - pec) / at) : (pec === 0 ? 0 : 1);
    if (taxaInv <= 0.02 && gap <= 0.02) return "OK";
    if (taxaInv <= 0.05 && gap <= 0.05) return "Alerta";
    return "Crítico";
  }
  function modeOrMulti(values){
    const map = new Map();
    for (const v of values){
      const s = (v ?? "").toString().trim();
      if (!s) continue;
      map.set(s, (map.get(s)||0)+1);
    }
    if (!map.size) return "—";
    let best = null, freq = -1;
    for (const [k,c] of map){ if (c > freq){ best = k; freq = c; } }
    return map.size === 1 ? best : (best + " (múltiplas)");
  }
  function formatInt(n){ return (n||0).toLocaleString("pt-BR"); }
  function pct(n){ return (n*100).toLocaleString("pt-BR", { maximumFractionDigits: 1 }) + "%"; }
  function escapeHtml(s){
    return (s||"").toString().replace(/[&<>"']/g, c => ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[c]));
  }

  // ---------- Dados de Exemplo (UNIDADES) ----------
  function loadExampleUnits(){
    datasetUnidades = [
      // Alhandra
      { cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA MATA REDONDA II", numeroPEC:"1136", versaoPEC:"5.4.21", importadoAtendente:7455, importadoPEC:7455, invalidas:11 },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA SALGADINHO",      numeroPEC:"1138", versaoPEC:"5.4.21", importadoAtendente:2268, importadoPEC:2268, invalidas:0  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA DO ACAIS",        numeroPEC:"1134", versaoPEC:"5.4.21", importadoAtendente:5608, importadoPEC:5608, invalidas:14 },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA OITEIRO II",      numeroPEC:"1019", versaoPEC:"5.4.21", importadoAtendente:7661, importadoPEC:7661, invalidas:9  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA MATA REDONDA I",  numeroPEC:"1135", versaoPEC:"5.4.21", importadoAtendente:3890, importadoPEC:3890, invalidas:9  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA NOVA ALHANDRA",   numeroPEC:"1137", versaoPEC:"5.4.21", importadoAtendente:2646, importadoPEC:2646, invalidas:2  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"CENTRO DE SAUDE DE ALHANDRA",                 numeroPEC:"1130", versaoPEC:"5.4.21", importadoAtendente:6493, importadoPEC:6493, invalidas:6  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UBS CENTRO ALHANDRA",                         numeroPEC:"1132", versaoPEC:"5.4.21", importadoAtendente:4612, importadoPEC:4612, invalidas:9  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"UNIDADE DE SAUDE DA FAMILIA CENTRO II",       numeroPEC:"1133", versaoPEC:"5.4.21", importadoAtendente:1951, importadoPEC:1951, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Alhandra", unidade:"POSTO ANCORA DE VIEIRA",                      numeroPEC:"1131", versaoPEC:"5.4.21", importadoAtendente:484,  importadoPEC:484,  invalidas:0  },//dataenvio: 17/12/2025
      // Alto do Rodrigues
      { cidade:"Alto do Rodrigues", unidade:"UNIDADE DE SAUDE DA FAMILIA DE TABATINGA", numeroPEC:"462", versaoPEC:"5.4.21", importadoAtendente:1,    importadoPEC:1,    invalidas:0   },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA VII",            numeroPEC:"461", versaoPEC:"5.4.21", importadoAtendente:1684, importadoPEC:1684, invalidas:12  },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA VI",             numeroPEC:"460", versaoPEC:"5.4.21", importadoAtendente:3895, importadoPEC:3895, invalidas:10  },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA V",              numeroPEC:"459", versaoPEC:"5.4.21", importadoAtendente:2745, importadoPEC:2745, invalidas:21  },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA IV",             numeroPEC:"458", versaoPEC:"5.4.21", importadoAtendente:852,  importadoPEC:852,  invalidas:16  },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA III",            numeroPEC:"457", versaoPEC:"5.4.21", importadoAtendente:3268, importadoPEC:3268, invalidas:158 },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA II",             numeroPEC:"456", versaoPEC:"5.4.21", importadoAtendente:3369, importadoPEC:3369, invalidas:18  },//dataenvio: 17/12/2025
{ cidade:"Alto do Rodrigues", unidade:"CENTRO DE SAUDE DA FAMILIA I",              numeroPEC:"455", versaoPEC:"5.4.21", importadoAtendente:1783, importadoPEC:1783, invalidas:167 },//dataenvio: 17/12/2025
      // Apodi
      { cidade:"Apodi", unidade:"POSTO DE SAUDE DE GOES",                            numeroPEC:"831", versaoPEC:"5.4.21", importadoAtendente:969,  importadoPEC:969,  invalidas:6   },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"UNIDADE BASICA DE SAUDE DA COMUNIDADE BICO TORTO",  numeroPEC:"838", versaoPEC:"5.4.21", importadoAtendente:3098, importadoPEC:3098, invalidas:5   },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"UBS GALDINO JULIAO DA MOTA",                        numeroPEC:"837", versaoPEC:"5.4.21", importadoAtendente:2393, importadoPEC:2393, invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"CENTRO DE SAUDE DE APODI",                          numeroPEC:"829", versaoPEC:"5.4.21", importadoAtendente:6734, importadoPEC:6734, invalidas:55  },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"UNIDADE BASICA DE SAUDE DO BACURAU I",              numeroPEC:"839", versaoPEC:"5.4.21", importadoAtendente:3490, importadoPEC:3490, invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"POSTO DE SAUDE SANTA ROSA",                         numeroPEC:"836", versaoPEC:"5.4.21", importadoAtendente:3260, importadoPEC:3260, invalidas:25  },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"UNIDADE BASICA DE SAUDE SAO SEBASTIAO",             numeroPEC:"842", versaoPEC:"5.4.21", importadoAtendente:4619, importadoPEC:4619, invalidas:109 },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"POSTO DE SAUDE DE SOLEDADE",                        numeroPEC:"832", versaoPEC:"5.4.21", importadoAtendente:6748, importadoPEC:6748, invalidas:24  },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"POSTO DE SAUDE DO BAMBURRAL",                       numeroPEC:"834", versaoPEC:"5.4.21", importadoAtendente:1007, importadoPEC:1007, invalidas:1   },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"POSTO DE SAUDE MELANCIAS",                          numeroPEC:"835", versaoPEC:"5.4.21", importadoAtendente:2061, importadoPEC:2061, invalidas:21  },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"UNIDADE BASICA DE SAUDE DO IPE",                    numeroPEC:"841", versaoPEC:"5.4.21", importadoAtendente:4640, importadoPEC:4640, invalidas:111 },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"POSTO DE SAUDE CORREGO",                            numeroPEC:"830", versaoPEC:"5.4.21", importadoAtendente:4015, importadoPEC:4015, invalidas:231 },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"UNIDADE BASICA DE SAUDE DO CAIC",                   numeroPEC:"840", versaoPEC:"5.4.21", importadoAtendente:8082, importadoPEC:8082, invalidas:132 },//dataenvio: 17/12/2025
{ cidade:"Apodi", unidade:"POSTO DE SAUDE DO ARCAO",                           numeroPEC:"833", versaoPEC:"5.4.21", importadoAtendente:1,    importadoPEC:1,    invalidas:0   },//dataenvio: 17/12/2025
      // Areia
     { cidade:"Areia", unidade:"ESF X MARIA DAS DORES MONTEIRO BARACHO MUTIRAO",          numeroPEC:"763", versaoPEC:"5.4.21", importadoAtendente:3570, importadoPEC:3570, invalidas:43  },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"ESF XI VEREADOR JOSEILTON SILVA",                         numeroPEC:"764", versaoPEC:"5.4.21", importadoAtendente:2633, importadoPEC:2633, invalidas:0   },//dataenvio: 18/12/2025
{ cidade:"Areia", unidade:"JOSE PAULINO DA SILVA ESF VII",                           numeroPEC:"766", versaoPEC:"5.4.21", importadoAtendente:2929, importadoPEC:2929, invalidas:0   },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"UNIDADE DE SAUDE DA FAMILIA DISTRITO SANTA MARIA",        numeroPEC:"760", versaoPEC:"5.4.21", importadoAtendente:4718, importadoPEC:4718, invalidas:1   },//dataenvio: 18/12/2025
{ cidade:"Areia", unidade:"JOSE EVARISTO DA SILVA ESF VIII",                         numeroPEC:"765", versaoPEC:"5.4.21", importadoAtendente:1298, importadoPEC:1298, invalidas:1   },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"PSF VI JUVENAL ESPINOLA",                                 numeroPEC:"769", versaoPEC:"5.4.21", importadoAtendente:3391, importadoPEC:3391, invalidas:3   },//dataenvio: 18/12/2025
{ cidade:"Areia", unidade:"PSF IV JOSE GUEDES DA COSTA",                             numeroPEC:"759", versaoPEC:"5.4.21", importadoAtendente:4682, importadoPEC:4682, invalidas:102 },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"POSTO DE SAUDE DR MORAES DE GALVAO PSF III",              numeroPEC:"767", versaoPEC:"5.4.21", importadoAtendente:3120, importadoPEC:3120, invalidas:7   },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"ESF IX FRANCISCO DE ASSIS GONDIM DISTRITO DE MUQUEM",     numeroPEC:"762", versaoPEC:"5.4.21", importadoAtendente:4212, importadoPEC:4212, invalidas:5   },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"PSF DE MATA LIMPA",                                       numeroPEC:"768", versaoPEC:"5.4.21", importadoAtendente:6902, importadoPEC:6902, invalidas:3   },//dataenvio: 17/12/2025
{ cidade:"Areia", unidade:"ANTONIO TRAJANO DOS SANTOS",                              numeroPEC:"761", versaoPEC:"5.4.21", importadoAtendente:4804, importadoPEC:4804, invalidas:6   },//dataenvio: 17/12/2025
      //Assu
      { cidade:"Assu", unidade:"UNIDADE DE SAUDE OSMAR BATISTA DA SILVA",       numeroPEC:"1294", versaoPEC:"5.4.21", importadoAtendente:2746, importadoPEC:2746, invalidas:23  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS BELA VISTA PIATO",                         numeroPEC:"1280", versaoPEC:"5.4.21", importadoAtendente:1621, importadoPEC:1621, invalidas:24  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS PANON II",                                 numeroPEC:"1291", versaoPEC:"5.4.21", importadoAtendente:2632, importadoPEC:2632, invalidas:193 },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS NOVA ESPERANCA",                           numeroPEC:"1288", versaoPEC:"5.4.21", importadoAtendente:1831, importadoPEC:1831, invalidas:9   },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS ORTENCIO FERREIRA LIMA",                   numeroPEC:"1290", versaoPEC:"5.4.21", importadoAtendente:3772, importadoPEC:3772, invalidas:11  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS DR FRANCISCO EVARISTO DE OLIVEIRA SALES",  numeroPEC:"1282", versaoPEC:"5.4.21", importadoAtendente:2968, importadoPEC:2968, invalidas:1   },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS ROBERIO ROBERTO BEZERRA",                  numeroPEC:"1292", versaoPEC:"5.4.21", importadoAtendente:3616, importadoPEC:3616, invalidas:54  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS JOANA FLORENCIO",                          numeroPEC:"1284", versaoPEC:"5.4.21", importadoAtendente:2168, importadoPEC:2168, invalidas:18  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS MORADA NOVA",                              numeroPEC:"1287", versaoPEC:"5.4.21", importadoAtendente:3953, importadoPEC:3953, invalidas:24  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS OFELIA WANDERLEY RODRIGUES",               numeroPEC:"1289", versaoPEC:"5.4.21", importadoAtendente:5280, importadoPEC:5280, invalidas:38  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS DO RIACHO",                                numeroPEC:"1281", versaoPEC:"5.4.21", importadoAtendente:1413, importadoPEC:1413, invalidas:15  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS ANTONIO CARLOS DANTAS DA SILVA",           numeroPEC:"1279", versaoPEC:"5.4.21", importadoAtendente:1658, importadoPEC:1658, invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS MARIA DA PENHA",                           numeroPEC:"1286", versaoPEC:"5.4.21", importadoAtendente:2323, importadoPEC:2323, invalidas:216 },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS JOSE DINARTE SOARES",                      numeroPEC:"1285", versaoPEC:"5.4.21", importadoAtendente:4094, importadoPEC:4094, invalidas:13  },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS JANDUIS",                                  numeroPEC:"1283", versaoPEC:"5.4.21", importadoAtendente:3439, importadoPEC:3439, invalidas:186 },//dataenvio: 17/12/2025
{ cidade:"Assu", unidade:"UBS SEVERINO MAIA",                            numeroPEC:"1293", versaoPEC:"5.4.21", importadoAtendente:1928, importadoPEC:1928, invalidas:14  },//dataenvio: 17/12/2025
      //Caldas Brandão
      { cidade:"Caldas Brandão", unidade:"PSF III VILA NOVA", numeroPEC:"209	", versaoPEC:"5.4.21", importadoAtendente:3267, importadoPEC:3267, invalidas:4 },//dataenvio: 18/12/2025
      { cidade:"Caldas Brandão", unidade:"PSF I DE CALDAS BRANDAO",  numeroPEC:"207", versaoPEC:"5.4.21", importadoAtendente:1105, importadoPEC:1105, invalidas:1 },//dataenvio: 18/12/2025
      { cidade:"Caldas Brandão", unidade:"PSF II CENTRO DE SAUDE DE CAJA",  numeroPEC:"208", versaoPEC:"5.4.21", importadoAtendente:5862, importadoPEC:5862, invalidas:6 },//dataenvio: 18/12/2025
      //Conde
      { cidade:"Conde", unidade:"UBS JOSE MANGUEIRA RAMALHO DR MANGUEIRA", numeroPEC:"492", versaoPEC:"5.4.21", importadoAtendente:2395, importadoPEC:2395, invalidas:3  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS VILLAGE",                             numeroPEC:"496", versaoPEC:"5.4.21", importadoAtendente:1022, importadoPEC:1022, invalidas:0  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS MITUACU",                             numeroPEC:"495", versaoPEC:"5.4.21", importadoAtendente:2257, importadoPEC:2257, invalidas:5  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS JACUMA",                              numeroPEC:"487", versaoPEC:"5.4.21", importadoAtendente:1777, importadoPEC:1777, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS NOSSA SENHORA DA CONCEICAO",          numeroPEC:"494", versaoPEC:"5.4.21", importadoAtendente:2864, importadoPEC:2864, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS MATA DA CHICA",                       numeroPEC:"493", versaoPEC:"5.4.21", importadoAtendente:1673, importadoPEC:1673, invalidas:0  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS CARAPIBUS",                           numeroPEC:"486", versaoPEC:"5.4.21", importadoAtendente:3632, importadoPEC:3632, invalidas:17 },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS CENTRO",                              numeroPEC:"491", versaoPEC:"5.4.21", importadoAtendente:7194, importadoPEC:7194, invalidas:11 },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS QUILOMBOLA DO GURUGI",                numeroPEC:"488", versaoPEC:"5.4.21", importadoAtendente:3374, importadoPEC:3374, invalidas:5  },//dataenvio: 18/12/2025
{ cidade:"Conde", unidade:"UBS POUSADA DO CONDE",                    numeroPEC:"489", versaoPEC:"5.4.21", importadoAtendente:2995, importadoPEC:2995, invalidas:2  },//dataenvio: 17/12/2025
{ cidade:"Conde", unidade:"UBS NOSSA SENHORA DAS NEVES",             numeroPEC:"490", versaoPEC:"5.4.21", importadoAtendente:4329, importadoPEC:4329, invalidas:13 },//dataenvio: 17/12/2025
      //Cordeiro
      { cidade:"Cordeiro", unidade:"PSF LAVRINHAS",      numeroPEC:"428", versaoPEC:"5.4.21", importadoAtendente:1588, importadoPEC:1588, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Cordeiro", unidade:"ESF RODOLFO",        numeroPEC:"426", versaoPEC:"5.4.21", importadoAtendente:1851, importadoPEC:1851, invalidas:0  },//dataenvio: 17/12/2025
{ cidade:"Cordeiro", unidade:"PSF MANANCIAL",      numeroPEC:"429", versaoPEC:"5.4.21", importadoAtendente:958,  importadoPEC:958,  invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Cordeiro", unidade:"PSF CENTRO",         numeroPEC:"427", versaoPEC:"5.4.21", importadoAtendente:5730, importadoPEC:5730, invalidas:31 },//dataenvio: 17/12/2025
{ cidade:"Cordeiro", unidade:"PSF RETIRO POETICO", numeroPEC:"430", versaoPEC:"5.4.21", importadoAtendente:2259, importadoPEC:2259, invalidas:2  },//dataenvio: 17/12/2025
{ cidade:"Cordeiro", unidade:"PSF SAO LUIZ",       numeroPEC:"431", versaoPEC:"5.4.21", importadoAtendente:1540, importadoPEC:1540, invalidas:0  },//dataenvio: 17/12/2025
      //Itabaiana
     { cidade:"Itabaiana", unidade:"UBSF ACUDE DAS PEDRAS",            numeroPEC:"631", versaoPEC:"5.4.21", importadoAtendente:1754, importadoPEC:1754, invalidas:4   },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF DE GUARITA",                  numeroPEC:"636", versaoPEC:"5.4.21", importadoAtendente:2088, importadoPEC:2088, invalidas:12  },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF SITIO NOVO",                  numeroPEC:"638", versaoPEC:"5.4.21", importadoAtendente:1729, importadoPEC:1729, invalidas:224 },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF CAMPO GRANDE",                numeroPEC:"633", versaoPEC:"5.4.21", importadoAtendente:2526, importadoPEC:2526, invalidas:88  },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF CASA DA MAE POBRE",           numeroPEC:"634", versaoPEC:"5.4.21", importadoAtendente:4104, importadoPEC:4104, invalidas:3   },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF PAULO OUVIDIO DE LUCENA",      numeroPEC:"637", versaoPEC:"5.4.21", importadoAtendente:3629, importadoPEC:3629, invalidas:5   },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF DE BREJINHO",                 numeroPEC:"630", versaoPEC:"5.4.21", importadoAtendente:6307, importadoPEC:6307, invalidas:113 },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF SUBURBANA",                   numeroPEC:"639", versaoPEC:"5.4.21", importadoAtendente:5155, importadoPEC:5155, invalidas:36  },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF BOTAFOGO",                    numeroPEC:"632", versaoPEC:"5.4.21", importadoAtendente:2675, importadoPEC:2675, invalidas:53  },//dataenvio: 17/12/2025
{ cidade:"Itabaiana", unidade:"UBSF COSTA E SILVA",               numeroPEC:"635", versaoPEC:"5.4.21", importadoAtendente:6401, importadoPEC:6401, invalidas:16  },//dataenvio: 17/12/2025
      //Itapororoca
      { cidade:"Itapororoca", unidade:"UNIDADE DE SAUDE DA FAMILIA CIPOAL",           numeroPEC:"882", versaoPEC:"5.4.21", importadoAtendente:954,  importadoPEC:954,  invalidas:43  },//dataenvio: 17/12/2025
{ cidade:"Itapororoca", unidade:"UNIDADE DE SAUDE DA FAMILIA CENTRO",           numeroPEC:"881", versaoPEC:"5.4.21", importadoAtendente:2203, importadoPEC:2203, invalidas:5   },//dataenvio: 17/12/2025
{ cidade:"Itapororoca", unidade:"UNIDADE DE SAUDE DA FAMILIA ROSEIRA",          numeroPEC:"885", versaoPEC:"5.4.21", importadoAtendente:4972, importadoPEC:4972, invalidas:55  },//dataenvio: 17/12/2025
{ cidade:"Itapororoca", unidade:"UNIDADE DE SAUDE DA FAMILIA IPIOCA DE BAIXO",  numeroPEC:"884", versaoPEC:"5.4.21", importadoAtendente:4225, importadoPEC:4225, invalidas:150 },//dataenvio: 17/12/2025
{ cidade:"Itapororoca", unidade:"UNIDADE BASICA DE SAUDE DO TAMBOR",            numeroPEC:"880", versaoPEC:"5.4.21", importadoAtendente:1794, importadoPEC:1794, invalidas:65  },//dataenvio: 17/12/2025
{ cidade:"Itapororoca", unidade:"UNIDADE DE SAUDE DA FAMILIA SAO JOAO",         numeroPEC:"886", versaoPEC:"5.4.21", importadoAtendente:5353, importadoPEC:5353, invalidas:18  },//dataenvio: 17/12/2025
{ cidade:"Itapororoca", unidade:"UNIDADE DE SAUDE DA FAMILIA CRUZEIRO",         numeroPEC:"883", versaoPEC:"5.4.21", importadoAtendente:2503, importadoPEC:2503, invalidas:47  },//dataenvio: 17/12/2025
      //Itatuba
      { cidade:"Itatuba", unidade:"UBSF VI JOSENALVA ARRUDA DE BRITO",            numeroPEC:"813", versaoPEC:"5.4.21", importadoAtendente:2982, importadoPEC:2982, invalidas:2  },//dataenvio: 17/12/2025
{ cidade:"Itatuba", unidade:"UBSF V",                                      numeroPEC:"812", versaoPEC:"5.4.21", importadoAtendente:4485, importadoPEC:4485, invalidas:15 },//dataenvio: 17/12/2025
{ cidade:"Itatuba", unidade:"UBSF IV",                                     numeroPEC:"811", versaoPEC:"5.4.21", importadoAtendente:4127, importadoPEC:4127, invalidas:3  },//dataenvio: 17/12/2025
{ cidade:"Itatuba", unidade:"UBSF III MARIA LUCIENE DE BRITO PEREIRA",      numeroPEC:"810", versaoPEC:"5.4.21", importadoAtendente:2235, importadoPEC:2235, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Itatuba", unidade:"UBSF II MARIA DAS NEVES MARTINS DE ANDRADE",   numeroPEC:"809", versaoPEC:"5.4.21", importadoAtendente:2014, importadoPEC:2014, invalidas:5  },//dataenvio: 17/12/2025
{ cidade:"Itatuba", unidade:"UBSF I SEVERINA MOREIRA",                      numeroPEC:"808", versaoPEC:"5.4.21", importadoAtendente:1740, importadoPEC:1740, invalidas:2  },//dataenvio: 17/12/2025
      //Mogeiro
      { cidade:"Mogeiro", unidade:"USF 7 SITIO CABRAL",                     numeroPEC:"484", versaoPEC:"5.4.21", importadoAtendente:2265, importadoPEC:2265, invalidas:18 },//dataenvio: 17/12/2025
{ cidade:"Mogeiro", unidade:"USF I MARIA DA GLORIA ALVES DA SILVA",    numeroPEC:"485", versaoPEC:"5.4.21", importadoAtendente:2238, importadoPEC:2238, invalidas:42 },//dataenvio: 17/12/2025
{ cidade:"Mogeiro", unidade:"USF II TEREZINHA BENICIO DA COSTA",       numeroPEC:"486", versaoPEC:"5.4.21", importadoAtendente:2433, importadoPEC:2433, invalidas:5  },//dataenvio: 17/12/2025
{ cidade:"Mogeiro", unidade:"USF III MARIA DO SOCORRO DA SILVA",       numeroPEC:"487", versaoPEC:"5.4.21", importadoAtendente:1149, importadoPEC:1149, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Mogeiro", unidade:"USF IV JOSEFA VICENCIA DA CONCEICAO",     numeroPEC:"488", versaoPEC:"5.4.21", importadoAtendente:2099, importadoPEC:2099, invalidas:6  },//dataenvio: 17/12/2025
{ cidade:"Mogeiro", unidade:"USF V JOSE PINTO DA SILVA",               numeroPEC:"489", versaoPEC:"5.4.21", importadoAtendente:3045, importadoPEC:3045, invalidas:10 },//dataenvio: 17/12/2025
{ cidade:"Mogeiro", unidade:"USF VI FRANCISCO CANDIDO DA SILVA",       numeroPEC:"490", versaoPEC:"5.4.21", importadoAtendente:3194, importadoPEC:3194, invalidas:92 },//dataenvio: 17/12/2025
      //Patu
      { cidade:"Patu", unidade:"UNIDADE BASICA DE SAUDE FRANCISCO LIMA",              numeroPEC:"430", versaoPEC:"5.4.21", importadoAtendente:2092, importadoPEC:2092, invalidas:7   },//dataenvio: 17/12/2025
{ cidade:"Patu", unidade:"UNIDADE DE SAUDE DA FAMILIA LOURIVAL ROCHA",          numeroPEC:"431", versaoPEC:"5.4.21", importadoAtendente:2854, importadoPEC:2854, invalidas:0   },//dataenvio: 17/12/2025
{ cidade:"Patu", unidade:"UNIDADE DE SAUDE DA FAMILIA ROSALITA FORTE DANTAS",   numeroPEC:"427", versaoPEC:"5.4.21", importadoAtendente:1896, importadoPEC:1896, invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Patu", unidade:"UNIDADE DE SAUDE DA FAMILIA JOAO INACIO",             numeroPEC:"428", versaoPEC:"5.4.21", importadoAtendente:1135, importadoPEC:1135, invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Patu", unidade:"UNIDADE BASICA DE SAUDE DR MAURICIO CORTEZ DE PAIVA", numeroPEC:"426", versaoPEC:"5.4.21", importadoAtendente:2508, importadoPEC:2508, invalidas:6   },//dataenvio: 17/12/2025
{ cidade:"Patu", unidade:"UNIDADE DE SAUDE DA FAMILIA FRANCISCO CICERO FILHO",  numeroPEC:"429", versaoPEC:"5.4.21", importadoAtendente:2902, importadoPEC:2902, invalidas:222 },//dataenvio: 17/12/2025
    //PedroAvelino
      { cidade:"PedroAvelino", unidade:"CENTRO DE SAUDE",                      numeroPEC:"195", versaoPEC:"5.4.21", importadoAtendente:2444, importadoPEC:2444, invalidas:7 },//dataenvio: 17/12/2025
{ cidade:"PedroAvelino", unidade:"UNID BASICA ZELITO CALACA",            numeroPEC:"197", versaoPEC:"5.4.21", importadoAtendente:2707, importadoPEC:2707, invalidas:2 },//dataenvio: 17/12/2025
{ cidade:"PedroAvelino", unidade:"POSTO DE SAUDE BAIXA DO MEIO",         numeroPEC:"196", versaoPEC:"5.4.21", importadoAtendente:1787, importadoPEC:1787, invalidas:1 },//dataenvio: 17/12/2025
{ cidade:"PedroAvelino", unidade:"UNIDADE BASICA DE SAUDE JOSE MARTINS", numeroPEC:"198", versaoPEC:"5.4.21", importadoAtendente:1383, importadoPEC:1383, invalidas:7 },//dataenvio: 17/12/2025
    //Pendencias
     { cidade:"Pendencias", unidade:"POSTO DE SAUDE VALDEMAR RODRIGUES DA SILVEIRA",   numeroPEC:"377", versaoPEC:"5.4.21", importadoAtendente:1614, importadoPEC:1614, invalidas:2 },//dataenvio: 17/12/2025
{ cidade:"Pendencias", unidade:"UBS DA FAMILIA LUZIA TORQUATO",                   numeroPEC:"378", versaoPEC:"5.4.21", importadoAtendente:1225, importadoPEC:1225, invalidas:2 },//dataenvio: 17/12/2025
{ cidade:"Pendencias", unidade:"CENTRO DE SAUDE MANOEL MOREIRA DA SILVA",         numeroPEC:"375", versaoPEC:"5.4.21", importadoAtendente:1405, importadoPEC:1405, invalidas:0 },//dataenvio: 17/12/2025
{ cidade:"Pendencias", unidade:"UBS MARIA DAS DORES BARBOSA",                     numeroPEC:"380", versaoPEC:"5.4.21", importadoAtendente:723,  importadoPEC:723,  invalidas:1 },//dataenvio: 17/12/2025
{ cidade:"Pendencias", unidade:"UBS DIMAS MARTINS CABRAL",                        numeroPEC:"379", versaoPEC:"5.4.21", importadoAtendente:1073, importadoPEC:1073, invalidas:3 },//dataenvio: 17/12/2025
{ cidade:"Pendencias", unidade:"POSTO DE SAUDE FRANCISCO HERMOGENES DE MEDEIROS", numeroPEC:"376", versaoPEC:"5.4.21", importadoAtendente:2082, importadoPEC:2082, invalidas:1 },//dataenvio: 17/12/2025
    //Pitimbu
      { cidade:"Pitimbu", unidade:"PSF PONTA DE COQUEIRO",                  numeroPEC:"495", versaoPEC:"5.4.21", importadoAtendente:3191, importadoPEC:3191, invalidas:3  },//dataenvio: 18/12/2025
{ cidade:"Pitimbu", unidade:"USF ACAU COLONIA",                       numeroPEC:"493", versaoPEC:"5.4.21", importadoAtendente:1850, importadoPEC:1850, invalidas:21 },//dataenvio: 18/12/2025
{ cidade:"Pitimbu", unidade:"USF PITIMBU VILA",                       numeroPEC:"487", versaoPEC:"5.4.21", importadoAtendente:1796, importadoPEC:1796, invalidas:20 },//dataenvio: 18/12/2025
{ cidade:"Pitimbu", unidade:"USF CAMUCIM",                            numeroPEC:"496", versaoPEC:"5.4.21", importadoAtendente:666,  importadoPEC:666,  invalidas:4  },//dataenvio: 17/12/2025
{ cidade:"Pitimbu", unidade:"USF ACAU MUCUIM",                        numeroPEC:"494", versaoPEC:"5.4.21", importadoAtendente:2483, importadoPEC:2483, invalidas:6  },//dataenvio: 17/12/2025
{ cidade:"Pitimbu", unidade:"USF PITIMBU GUARITA",                    numeroPEC:"492", versaoPEC:"5.4.21", importadoAtendente:2173, importadoPEC:2173, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Pitimbu", unidade:"USF APAZA",                              numeroPEC:"491", versaoPEC:"5.4.21", importadoAtendente:1804, importadoPEC:1804, invalidas:0  },//dataenvio: 17/12/2025
{ cidade:"Pitimbu", unidade:"USF TAQUARA",                            numeroPEC:"490", versaoPEC:"5.4.21", importadoAtendente:1761, importadoPEC:1761, invalidas:2  },//dataenvio: 17/12/2025
{ cidade:"Pitimbu", unidade:"UBS COSMO VALDEVINO DOS SANTOS ANDREZA", numeroPEC:"489", versaoPEC:"5.4.21", importadoAtendente:2153, importadoPEC:2153, invalidas:5  },//dataenvio: 17/12/2025
    //PocoBranco
      { cidade:"PocoBranco", unidade:"CENTRO CLINICO DE ESPECIALIDADES", numeroPEC:"0",   versaoPEC:"5.4.21", importadoAtendente:0,    importadoPEC:0,    invalidas:0 },//dataenvio: 11/12/2025
{ cidade:"PocoBranco", unidade:"UNIDADE BASICA DE SAUDE UBS 3",     numeroPEC:"483", versaoPEC:"5.4.21", importadoAtendente:1741, importadoPEC:1741, invalidas:7  },//dataenvio: 17/12/2025
{ cidade:"PocoBranco", unidade:"UNIDADE BASICA DE SAUDE UBS 5",     numeroPEC:"482", versaoPEC:"5.4.21", importadoAtendente:3538, importadoPEC:3538, invalidas:62 },//dataenvio: 17/12/2025
{ cidade:"PocoBranco", unidade:"UNIDADE BASICA DE SAUDE UBS 4",     numeroPEC:"481", versaoPEC:"5.4.21", importadoAtendente:2127, importadoPEC:2127, invalidas:3  },//dataenvio: 17/12/2025
{ cidade:"PocoBranco", unidade:"UBS BAIXOS DE SAO MIGUEL",          numeroPEC:"480", versaoPEC:"5.4.21", importadoAtendente:1341, importadoPEC:1341, invalidas:9  },//dataenvio: 17/12/2025
{ cidade:"PocoBranco", unidade:"UNIDADE BASICA DE SAUDE UBS 2",     numeroPEC:"479", versaoPEC:"5.4.21", importadoAtendente:4560, importadoPEC:4560, invalidas:10 },//dataenvio: 17/12/2025
{ cidade:"PocoBranco", unidade:"UNIDADE BASICA DE SAUDE UBS 6",     numeroPEC:"478", versaoPEC:"5.4.21", importadoAtendente:1128, importadoPEC:1128, invalidas:3  },//dataenvio: 17/12/2025
{ cidade:"PocoBranco", unidade:"UNIDADE BASICA DE SAUDE UBS 1",     numeroPEC:"477", versaoPEC:"5.4.21", importadoAtendente:3888, importadoPEC:3888, invalidas:75 },//dataenvio: 17/12/2025
    //São José de Ubá
      { cidade:"SãoJosédeUbá", unidade:"ESTRATEGIA DA SAUDE DA FAMILIA ESF WASHINGTON BISMARCK NEY", numeroPEC:"397", versaoPEC:"5.4.21", importadoAtendente:1636, importadoPEC:1636, invalidas:57  },//dataenvio: 18/12/2025
{ cidade:"SãoJosédeUbá", unidade:"ESTRATEGIA DA SAUDE DA FAMILIA ESF DR EVERARDO TRAVASSOS",   numeroPEC:"396", versaoPEC:"5.4.21", importadoAtendente:1724, importadoPEC:1724, invalidas:160 },//dataenvio: 18/12/2025
{ cidade:"SãoJosédeUbá", unidade:"ESTRATEGIA DA SAUDE DA FAMILIA ESF ANTONIO MORAES FILHO",    numeroPEC:"395", versaoPEC:"5.4.21", importadoAtendente:1790, importadoPEC:1790, invalidas:6   },//dataenvio: 18/12/2025
{ cidade:"SãoJosédeUbá", unidade:"ESTRATEGIA DA SAUDE DA FAMILIA ANALIA FIQUEIRA LESSA",       numeroPEC:"394", versaoPEC:"5.4.21", importadoAtendente:1779, importadoPEC:1779, invalidas:58  },//dataenvio: 18/12/2025
      //Tibau
      { cidade:"Tibau", unidade:"UNIDADE MISTA DE SAUDE SANTA TEREZINHA",          numeroPEC:"239", versaoPEC:"5.4.21", importadoAtendente:1,    importadoPEC:1,    invalidas:0 },//dataenvio: 17/12/2025
{ cidade:"Tibau", unidade:"UNIDADE MARIA IRISMAR NOLASCO",                   numeroPEC:"238", versaoPEC:"5.4.21", importadoAtendente:2911, importadoPEC:2911, invalidas:18 },//dataenvio: 17/12/2025
{ cidade:"Tibau", unidade:"UNIDADE BASICA DE SAUDE TEREZINHA LIMA PESSOA",    numeroPEC:"237", versaoPEC:"5.4.21", importadoAtendente:1075, importadoPEC:1075, invalidas:5 },//dataenvio: 17/12/2025
      //Trajano
      { cidade:"Trajano", unidade:"PSF DR ELIAS",             numeroPEC:"124", versaoPEC:"5.4.21", importadoAtendente:1631, importadoPEC:1631, invalidas:15 },//dataenvio: 17/12/2025
{ cidade:"Trajano", unidade:"POSTO DE SAUDE PONTE NOVA",numeroPEC:"129", versaoPEC:"5.4.21", importadoAtendente:3,    importadoPEC:3,    invalidas:0  },//dataenvio: 17/12/2025
{ cidade:"Trajano", unidade:"ESF JALMEIR MORAIS VIANA",  numeroPEC:"128", versaoPEC:"5.4.21", importadoAtendente:334,  importadoPEC:334,  invalidas:4  },//dataenvio: 17/12/2025
{ cidade:"Trajano", unidade:"PSF MARIA MENDONCA",        numeroPEC:"127", versaoPEC:"5.4.21", importadoAtendente:830,  importadoPEC:830,  invalidas:4  },//dataenvio: 18/12/2025
{ cidade:"Trajano", unidade:"PSF TAPERA",                numeroPEC:"126", versaoPEC:"5.4.21", importadoAtendente:2151, importadoPEC:2151, invalidas:1  },//dataenvio: 17/12/2025
{ cidade:"Trajano", unidade:"PSF REPRESA",               numeroPEC:"125", versaoPEC:"5.4.21", importadoAtendente:1646, importadoPEC:1646, invalidas:2  },//dataenvio: 17/12/2025
      //Brumado
      { cidade:"Brumado", unidade:"USF VEREADOR SINVAL NEVES",                              numeroPEC:"1503", versaoPEC:"5.4.21", importadoAtendente:3832,  importadoPEC:3832,  invalidas:0   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF MARCIONILIO RODRIGUES DOS SANTOS",                   numeroPEC:"1502", versaoPEC:"5.4.21", importadoAtendente:7304,  importadoPEC:7304,  invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF LIZIANE DOS SANTOS ALVES",                           numeroPEC:"1501", versaoPEC:"5.4.21", importadoAtendente:13175, importadoPEC:13175, invalidas:79  },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF LEOBINO JOSE DE SOUZA",                              numeroPEC:"1500", versaoPEC:"5.4.21", importadoAtendente:2055,  importadoPEC:2055,  invalidas:12  },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF JOAQUIM DE CASTRO DONATO",                           numeroPEC:"1499", versaoPEC:"5.4.21", importadoAtendente:5115,  importadoPEC:5115,  invalidas:19  },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF IVANEIDE DAS NEVES SANTOS TEIXEIRA",                 numeroPEC:"1498", versaoPEC:"5.4.21", importadoAtendente:3125,  importadoPEC:3125,  invalidas:3   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF FERNANDO LUIZ GONCALVES TRINDADE",                   numeroPEC:"1497", versaoPEC:"5.4.21", importadoAtendente:4865,  importadoPEC:4865,  invalidas:4   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF ENFERMEIRA KEILA FRANCIOLE LIMA ALVES TEIXEIRA",     numeroPEC:"1496", versaoPEC:"5.4.21", importadoAtendente:6230,  importadoPEC:6230,  invalidas:1   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"USF ALTINO ELIZEU DE SOUZA",                             numeroPEC:"1495", versaoPEC:"5.4.21", importadoAtendente:2304,  importadoPEC:2304,  invalidas:196 },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"UNIDADE DE SAUDE DA FAMILIA WILSON TIBO",                numeroPEC:"1494", versaoPEC:"5.4.21", importadoAtendente:3905,  importadoPEC:3905,  invalidas:0   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"UNIDADE DE SAUDE DA FAMILIA RAIMUNDO FERNANDES",         numeroPEC:"1493", versaoPEC:"5.4.21", importadoAtendente:4961,  importadoPEC:4961,  invalidas:2   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"UNIDADE DE SAUDE DA FAMILIA JUVENCIO SOUZA LIMA",        numeroPEC:"1492", versaoPEC:"5.4.21", importadoAtendente:4380,  importadoPEC:4380,  invalidas:8   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"UNIDADE DE SAUDE DA FAMILIA DR PAULO VARGAS",            numeroPEC:"1491", versaoPEC:"5.4.21", importadoAtendente:3674,  importadoPEC:3674,  invalidas:14  },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"UNIDADE DE SAUDE DA FAMILIA DR NEWTON ALVES DE CASTRO",  numeroPEC:"1490", versaoPEC:"5.4.21", importadoAtendente:4909,  importadoPEC:4909,  invalidas:6   },//dataenvio: 17/12/2025
{ cidade:"Brumado", unidade:"UNIDADE DE SAUDE DA FAMILIA DR ARLINDO MAGNO STANCHI",   numeroPEC:"1489", versaoPEC:"5.4.21", importadoAtendente:5862,  importadoPEC:5862,  invalidas:9   },//dataenvio: 17/12/2025
      //FrancoDaRocha
      { cidade:"FrancoDaRocha", unidade:"UBS ANA MARIA CALEFI MOREIRA",                           numeroPEC:"959", versaoPEC:"5.4.21", importadoAtendente:284,   importadoPEC:284,   invalidas:33 },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UNIDADE BASICA DE SAUDE VER RODRIGO DA CRUZ FRANCA",     numeroPEC:"958", versaoPEC:"5.4.21", importadoAtendente:5067,  importadoPEC:5067,  invalidas:24 },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UNIDADE BASICA DE SAUDE PASTOR ELIAS PEREIRA",           numeroPEC:"957", versaoPEC:"5.4.21", importadoAtendente:2093,  importadoPEC:2093,  invalidas:9  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UNIDADE BASICA DE SAUDE JOSE GRACIANO CORDEIRO FERREIRA",numeroPEC:"956", versaoPEC:"5.4.21", importadoAtendente:7788,  importadoPEC:7788,  invalidas:31 },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UNIDADE BASICA DE SAUDE AFONSO NOBRE BAIA",              numeroPEC:"955", versaoPEC:"5.4.21", importadoAtendente:10297, importadoPEC:10297, invalidas:7  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UNIDADE BASICA DE SAUDE ADILSON GOMES DE SA",            numeroPEC:"954", versaoPEC:"5.4.21", importadoAtendente:1462,  importadoPEC:1462,  invalidas:7  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS VEREADOR GILSON GABRIEL ROSA",                       numeroPEC:"953", versaoPEC:"5.4.21", importadoAtendente:1171,  importadoPEC:1171,  invalidas:54 },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS NEUSA RAMOS ROSSI",                                  numeroPEC:"952", versaoPEC:"5.4.21", importadoAtendente:3581,  importadoPEC:3581,  invalidas:3  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS MARCELO GOES DE SOUZA",                              numeroPEC:"951", versaoPEC:"5.4.21", importadoAtendente:2542,  importadoPEC:2542,  invalidas:2  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS JULIA TEIXEIRA DA SILVA",                            numeroPEC:"950", versaoPEC:"5.4.21", importadoAtendente:215,   importadoPEC:215,   invalidas:0  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS ENF ROSA GENOVEVA DOS REIS",                         numeroPEC:"949", versaoPEC:"5.4.21", importadoAtendente:3220,  importadoPEC:3220,  invalidas:0  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS DR OSORIO CESAR",                                    numeroPEC:"948", versaoPEC:"5.4.21", importadoAtendente:10644, importadoPEC:10644, invalidas:7  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS DR LEOPOLDINO JOSE DOS PASSOS",                      numeroPEC:"947", versaoPEC:"5.4.21", importadoAtendente:4848,  importadoPEC:4848,  invalidas:6  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS ANTONIO DE PAULA LIMA",                              numeroPEC:"946", versaoPEC:"5.4.21", importadoAtendente:5145,  importadoPEC:5145,  invalidas:2  },//dataenvio: 18/12/2025
{ cidade:"FrancoDaRocha", unidade:"UBS ANTONIA ELIAS DE ARAUJO CAVALCANTI",                 numeroPEC:"945", versaoPEC:"5.4.21", importadoAtendente:2053,  importadoPEC:2053,  invalidas:2  },//dataenvio: 18/12/2025
      //Macaiba
      { cidade:"Macaiba", unidade:"E S F MANGABEIRA II", numeroPEC:"1130", versaoPEC:"5.4.21", importadoAtendente:2350, importadoPEC:2350, invalidas:1 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F DE GUARAPES", numeroPEC:"1121", versaoPEC:"5.4.21", importadoAtendente:902,  importadoPEC:902,  invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CAMPESTRE", numeroPEC:"1114", versaoPEC:"5.4.21", importadoAtendente:1234, importadoPEC:1234, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CAMPO DAS MANGUEIRAS", numeroPEC:"1117", versaoPEC:"5.4.21", importadoAtendente:590,  importadoPEC:590,  invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F FERREIRO TORTO", numeroPEC:"1123", versaoPEC:"5.4.21", importadoAtendente:1498, importadoPEC:1498, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F LAGOA DOS CAVALOS", numeroPEC:"1126", versaoPEC:"5.4.21", importadoAtendente:1716, importadoPEC:1716, invalidas:15 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F TRAIRAS", numeroPEC:"1135", versaoPEC:"5.4.21", importadoAtendente:2026, importadoPEC:2026, invalidas:1 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"VILA SAO JOSE II", numeroPEC:"1139", versaoPEC:"5.4.21", importadoAtendente:2691, importadoPEC:2691, invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CAMPO SANTO", numeroPEC:"1118", versaoPEC:"5.4.21", importadoAtendente:746,  importadoPEC:746,  invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F AS MARIAS", numeroPEC:"1111", versaoPEC:"5.4.21", importadoAtendente:2058, importadoPEC:2058, invalidas:1 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F VILA SAO JOSE", numeroPEC:"1136", versaoPEC:"5.4.21", importadoAtendente:2316, importadoPEC:2316, invalidas:5 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F RIACHO DO SANGUE", numeroPEC:"1133", versaoPEC:"5.4.21", importadoAtendente:2268, importadoPEC:2268, invalidas:3 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F MANGABEIRA", numeroPEC:"1129", versaoPEC:"5.4.21", importadoAtendente:1971, importadoPEC:1971, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F DE CAPOEIRAS", numeroPEC:"1120", versaoPEC:"5.4.21", importadoAtendente:793,  importadoPEC:793,  invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F POTENGI", numeroPEC:"1132", versaoPEC:"5.4.21", importadoAtendente:2497, importadoPEC:2497, invalidas:4 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F LAGOA DO SITIO", numeroPEC:"1125", versaoPEC:"5.4.21", importadoAtendente:1561, importadoPEC:1561, invalidas:4 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F LUIZ ANTONIO DA FONSECA", numeroPEC:"1128", versaoPEC:"5.4.21", importadoAtendente:1182, importadoPEC:1182, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F TAPARA", numeroPEC:"1134", versaoPEC:"5.4.21", importadoAtendente:1578, importadoPEC:1578, invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CAJAZEIRAS", numeroPEC:"1113", versaoPEC:"5.4.21", importadoAtendente:1644, importadoPEC:1644, invalidas:1 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CAMPINAS", numeroPEC:"1115", versaoPEC:"5.4.21", importadoAtendente:2318, importadoPEC:2318, invalidas:3 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F JOSE COELHO", numeroPEC:"1124", versaoPEC:"5.4.21", importadoAtendente:1315, importadoPEC:1315, invalidas:1 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F ELOI DE SOUZA", numeroPEC:"1122", versaoPEC:"5.4.21", importadoAtendente:859,  importadoPEC:859,  invalidas:1 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F VILAR", numeroPEC:"1137", versaoPEC:"5.4.21", importadoAtendente:1848, importadoPEC:1848, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F LOTEAMENTO ESPERANCA", numeroPEC:"1127", versaoPEC:"5.4.21", importadoAtendente:924,  importadoPEC:924,  invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F MORADA DA FE", numeroPEC:"1131", versaoPEC:"5.4.21", importadoAtendente:3172, importadoPEC:3172, invalidas:4 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CANA BRAVA", numeroPEC:"1119", versaoPEC:"5.4.21", importadoAtendente:3358, importadoPEC:3358, invalidas:3 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F CAMPO DA SANTA CRUZ", numeroPEC:"1116", versaoPEC:"5.4.21", importadoAtendente:663,  importadoPEC:663,  invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Macaiba", unidade:"E S F BELA VISTA", numeroPEC:"1112", versaoPEC:"5.4.21", importadoAtendente:3191, importadoPEC:3191, invalidas:3 }, //dataenvio: 17/12/2025
      //SantaRita
      { cidade:"SantaRita", unidade:"UNIDADE DE PSF VIDAL DE NEGREIROS", numeroPEC:"2407", versaoPEC:"5.4.21", importadoAtendente:3146, importadoPEC:3146, invalidas:93 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF USINA SAO JOAO", numeroPEC:"2412", versaoPEC:"5.4.21", importadoAtendente:659,  importadoPEC:659,  invalidas:1 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF PREFEITO DR OILDO SOARES", numeroPEC:"2399", versaoPEC:"5.4.21", importadoAtendente:1769, importadoPEC:1769, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF PEDRO CICERO BENICIO", numeroPEC:"2375", versaoPEC:"5.4.21", importadoAtendente:2597, importadoPEC:2597, invalidas:8 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF PADRE PAULO KOELLEN", numeroPEC:"2377", versaoPEC:"5.4.21", importadoAtendente:3509, importadoPEC:3509, invalidas:41 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF PADRE MALAGRIDA I", numeroPEC:"2381", versaoPEC:"5.4.21", importadoAtendente:2280, importadoPEC:2280, invalidas:1 },  //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF ODON LEITE", numeroPEC:"2392", versaoPEC:"5.4.21", importadoAtendente:2160, importadoPEC:2160, invalidas:32 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF MIRIRI", numeroPEC:"2401", versaoPEC:"5.4.21", importadoAtendente:884,  importadoPEC:884,  invalidas:23 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF MAURICE VAN WOENSEL", numeroPEC:"2402", versaoPEC:"5.4.21", importadoAtendente:958,  importadoPEC:958,  invalidas:3 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF MARIA DE LOURDES ALVES DE ASSIS", numeroPEC:"2386", versaoPEC:"5.4.21", importadoAtendente:2465, importadoPEC:2465, invalidas:31 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF MARCOS MOURA III", numeroPEC:"2380", versaoPEC:"5.4.21", importadoAtendente:940,  importadoPEC:940,  invalidas:5 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF MARCOS MOURA II", numeroPEC:"2372", versaoPEC:"5.4.21", importadoAtendente:3354, importadoPEC:3354, invalidas:46 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF LIVRAMENTO", numeroPEC:"2382", versaoPEC:"5.4.21", importadoAtendente:2257, importadoPEC:2257, invalidas:4 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF LEROLANDIA", numeroPEC:"2379", versaoPEC:"5.4.21", importadoAtendente:2991, importadoPEC:2991, invalidas:12 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF JOSE VICENTE DE PONTES", numeroPEC:"2385", versaoPEC:"5.4.21", importadoAtendente:1876, importadoPEC:1876, invalidas:13 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF JOSE ALVES VIEIRA", numeroPEC:"2394", versaoPEC:"5.4.21", importadoAtendente:2688, importadoPEC:2688, invalidas:1 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF JOSE ALVES DE MELO", numeroPEC:"2404", versaoPEC:"5.4.21", importadoAtendente:1649, importadoPEC:1649, invalidas:3 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF JOAQUIM FRANCISCO DE SOUZA", numeroPEC:"2391", versaoPEC:"5.4.21", importadoAtendente:625,  importadoPEC:625,  invalidas:11 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF JOAO BATISTA DO NASCIMENTO", numeroPEC:"2397", versaoPEC:"5.4.21", importadoAtendente:3507, importadoPEC:3507, invalidas:101 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF IZABEL SERRANO DA SILVA", numeroPEC:"2371", versaoPEC:"5.4.21", importadoAtendente:2153, importadoPEC:2153, invalidas:7 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF IRMA CACILDA", numeroPEC:"2388", versaoPEC:"5.4.21", importadoAtendente:2627, importadoPEC:2627, invalidas:3 },  //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF HEITEL SANTIAGO", numeroPEC:"2387", versaoPEC:"5.4.21", importadoAtendente:3464, importadoPEC:3464, invalidas:54 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF FRANCISCA PANTA", numeroPEC:"2398", versaoPEC:"5.4.21", importadoAtendente:4313, importadoPEC:4313, invalidas:60 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF FRANCISCA MORAIS DE QUEIROGA", numeroPEC:"2406", versaoPEC:"5.4.21", importadoAtendente:1346, importadoPEC:1346, invalidas:32 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF FRANCISCA LIRA DE CARVALHO", numeroPEC:"2409", versaoPEC:"5.4.21", importadoAtendente:2776, importadoPEC:2776, invalidas:14 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF FORTE VELHORIBEIRA", numeroPEC:"2411", versaoPEC:"5.4.21", importadoAtendente:1287, importadoPEC:1287, invalidas:2 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF FLAVIO MAROJA", numeroPEC:"2403", versaoPEC:"5.4.21", importadoAtendente:741,  importadoPEC:741,  invalidas:8 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF FARM ANTONIO AZEVEDO", numeroPEC:"2374", versaoPEC:"5.4.21", importadoAtendente:3126, importadoPEC:3126, invalidas:10 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF ENF MARCIA VALERIA RODRIGUES", numeroPEC:"2395", versaoPEC:"5.4.21", importadoAtendente:2261, importadoPEC:2261, invalidas:3 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF DR TEIXEIRA DE VASCONCELOS", numeroPEC:"2400", versaoPEC:"5.4.21", importadoAtendente:3267, importadoPEC:3267, invalidas:46 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF DR ROMEU DE AZEVEDO MENEZES", numeroPEC:"2383", versaoPEC:"5.4.21", importadoAtendente:3244, importadoPEC:3244, invalidas:46 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF DR DORIVALDO PEREIRA DA SILVA", numeroPEC:"2384", versaoPEC:"5.4.21", importadoAtendente:2538, importadoPEC:2538, invalidas:12 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF DR CARLOS ANTONIO", numeroPEC:"2396", versaoPEC:"5.4.21", importadoAtendente:1723, importadoPEC:1723, invalidas:1 },  //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF DONA ZUZA ALVINO", numeroPEC:"2376", versaoPEC:"5.4.21", importadoAtendente:2458, importadoPEC:2458, invalidas:42 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF CELIA SANTIAGO", numeroPEC:"2390", versaoPEC:"5.4.21", importadoAtendente:6148, importadoPEC:6148, invalidas:301 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF CELESTE RIBEIRO", numeroPEC:"2389", versaoPEC:"5.4.21", importadoAtendente:4169, importadoPEC:4169, invalidas:35 }, //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF CARMEM LUCIA FIRMINO DA SILVA", numeroPEC:"2393", versaoPEC:"5.4.21", importadoAtendente:2212, importadoPEC:2212, invalidas:21 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF BEBELANDIA", numeroPEC:"2373", versaoPEC:"5.4.21", importadoAtendente:1595, importadoPEC:1595, invalidas:77 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF BARAO DO ABIAY", numeroPEC:"2405", versaoPEC:"5.4.21", importadoAtendente:480,  importadoPEC:480,  invalidas:0 },  //dataenvio: 17/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF ANA VIRGINIA", numeroPEC:"2378", versaoPEC:"5.4.21", importadoAtendente:3607, importadoPEC:3607, invalidas:13 }, //dataenvio: 18/12/2025
{ cidade:"SantaRita", unidade:"UNIDADE DE PSF ALDENY MONTENEGRO", numeroPEC:"2408", versaoPEC:"5.4.21", importadoAtendente:1324, importadoPEC:1324, invalidas:46 }, //dataenvio: 17/12/2025
      //Valença
      { cidade:"Valença", unidade:"ESF SAO FRANCISCO",           numeroPEC:"1636", versaoPEC:"5.4.21", importadoAtendente:817,  importadoPEC:817,  invalidas:2  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"UBS CHACRINHA",               numeroPEC:"1641", versaoPEC:"5.4.21", importadoAtendente:1099, importadoPEC:1099, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF OSORIO",                  numeroPEC:"1631", versaoPEC:"5.4.21", importadoAtendente:3069, importadoPEC:3069, invalidas:88 }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF SANTA ISABEL",            numeroPEC:"1635", versaoPEC:"5.4.21", importadoAtendente:1961, importadoPEC:1961, invalidas:0  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF BIQUINHA",                numeroPEC:"1621", versaoPEC:"5.4.21", importadoAtendente:2290, importadoPEC:2290, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF PENTAGNA",                numeroPEC:"1634", versaoPEC:"5.4.21", importadoAtendente:1294, importadoPEC:1294, invalidas:2  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"UBS LARANJEIRAS",             numeroPEC:"1642", versaoPEC:"5.4.21", importadoAtendente:2290, importadoPEC:2290, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF BARROSO",                 numeroPEC:"1620", versaoPEC:"5.4.21", importadoAtendente:3397, importadoPEC:3397, invalidas:4  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF BAIRRO DE FATIMA",        numeroPEC:"1619", versaoPEC:"5.4.21", importadoAtendente:2901, importadoPEC:2901, invalidas:11 }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"UBS PASSAGEM",                numeroPEC:"1643", versaoPEC:"5.4.21", importadoAtendente:299,  importadoPEC:299,  invalidas:0  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF JUPARANA CENTRO",         numeroPEC:"1630", versaoPEC:"5.4.21", importadoAtendente:1967, importadoPEC:1967, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF SAO JOSE DAS PALMEIRAS",  numeroPEC:"1637", versaoPEC:"5.4.21", importadoAtendente:3998, importadoPEC:3998, invalidas:5  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF HILDEBRANDO LOPES",       numeroPEC:"1625", versaoPEC:"5.4.21", importadoAtendente:2225, importadoPEC:2225, invalidas:2  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF PARQUE PENTAGNA",         numeroPEC:"1633", versaoPEC:"5.4.21", importadoAtendente:4800, importadoPEC:4800, invalidas:7  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF JARDIM VALENCA",          numeroPEC:"1626", versaoPEC:"5.4.21", importadoAtendente:4858, importadoPEC:4858, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF CENTRO",                  numeroPEC:"1623", versaoPEC:"5.4.21", importadoAtendente:3031, importadoPEC:3031, invalidas:3  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF JOAO BONITO",             numeroPEC:"1627", versaoPEC:"5.4.21", importadoAtendente:4321, importadoPEC:4321, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF JOAO DIAS",               numeroPEC:"1628", versaoPEC:"5.4.21", importadoAtendente:1839, importadoPEC:1839, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"UBS QUIRINO",                 numeroPEC:"1644", versaoPEC:"5.4.21", importadoAtendente:1139, importadoPEC:1139, invalidas:1  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF PARAPEUNA",               numeroPEC:"1632", versaoPEC:"5.4.21", importadoAtendente:2711, importadoPEC:2711, invalidas:3  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF CONSERVATORIA",           numeroPEC:"1624", versaoPEC:"5.4.21", importadoAtendente:4321, importadoPEC:4321, invalidas:3  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF CAMBOTA",                 numeroPEC:"1622", versaoPEC:"5.4.21", importadoAtendente:4428, importadoPEC:4428, invalidas:4  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF JUPARANA",                numeroPEC:"1629", versaoPEC:"5.4.21", importadoAtendente:2159, importadoPEC:2159, invalidas:2  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF VARGINHA",                numeroPEC:"1639", versaoPEC:"5.4.21", importadoAtendente:5958, importadoPEC:5958, invalidas:4  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"UBS CANTEIRO",                numeroPEC:"1640", versaoPEC:"5.4.21", importadoAtendente:1585, importadoPEC:1585, invalidas:0  }, //dataenvio: 17/12/2025
{ cidade:"Valença", unidade:"ESF SPALLA II",               numeroPEC:"1638", versaoPEC:"5.4.21", importadoAtendente:2504, importadoPEC:2504, invalidas:0  }, //dataenvio: 17/12/2025
      //Viçosa
      { cidade:"Viçosa", unidade:"DIVISAO DE SAUDE", numeroPEC:"0", versaoPEC:"5.4.21", importadoAtendente:0,    importadoPEC:0,    invalidas:0 },  //dataenvio: 27/11/2025
{ cidade:"Viçosa", unidade:"CISMIV", numeroPEC:"850", versaoPEC:"5.4.21", importadoAtendente:2,    importadoPEC:2,    invalidas:0 },  //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"POLICLINICA DE VICOSA", numeroPEC:"792", versaoPEC:"5.4.21", importadoAtendente:1620, importadoPEC:1620, invalidas:0 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA SAO JOSE DO TRIUNFO", numeroPEC:"838", versaoPEC:"5.4.21", importadoAtendente:2856, importadoPEC:2856, invalidas:21 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA AMORAS", numeroPEC:"796", versaoPEC:"5.4.21", importadoAtendente:2746, importadoPEC:2746, invalidas:4 }, //dataenvio: 18/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA NOVA VICOSA POSSES", numeroPEC:"822", versaoPEC:"5.4.21", importadoAtendente:5659, importadoPEC:5659, invalidas:6 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA STA CLARA BETANIA JK M EUGENIA", numeroPEC:"795", versaoPEC:"5.4.21", importadoAtendente:9498, importadoPEC:9498, invalidas:8 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA NOVA ERA INACIO MARTINS", numeroPEC:"841", versaoPEC:"5.4.21", importadoAtendente:5318, importadoPEC:5318, invalidas:23 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA NOVO SILVESTRE", numeroPEC:"790", versaoPEC:"5.4.21", importadoAtendente:1932, importadoPEC:1932, invalidas:14 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA SANTO ANTONIO", numeroPEC:"798", versaoPEC:"5.4.21", importadoAtendente:4545, importadoPEC:4545, invalidas:13 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA BOM JESUS", numeroPEC:"801", versaoPEC:"5.4.21", importadoAtendente:5978, importadoPEC:5978, invalidas:8 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA SANTO ANTONIO II", numeroPEC:"799", versaoPEC:"5.4.21", importadoAtendente:4457, importadoPEC:4457, invalidas:22 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA FRANCISCO DE PAULA OLIVEIRA", numeroPEC:"794", versaoPEC:"5.4.21", importadoAtendente:2983, importadoPEC:2983, invalidas:57 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA SILVESTRE", numeroPEC:"797", versaoPEC:"5.4.21", importadoAtendente:2749, importadoPEC:2749, invalidas:12 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA JOAO BRAS", numeroPEC:"793", versaoPEC:"5.4.21", importadoAtendente:2815, importadoPEC:2815, invalidas:2 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA SAO SEBASTIAO UNIAO VALE DO SOL", numeroPEC:"800", versaoPEC:"5.4.21", importadoAtendente:2479, importadoPEC:2479, invalidas:3 }, //dataenvio: 17/12/2025
{ cidade:"Viçosa", unidade:"UNIDADE SAUDE DA FAMILIA SAO JOSE CIDADE NOVA BARRINHA", numeroPEC:"791", versaoPEC:"5.4.21", importadoAtendente:4591, importadoPEC:4591, invalidas:29 }, //dataenvio: 18/12/2025

    ];
  }

  // ---------- Persistência ----------
  function save(){
    try{ localStorage.setItem("novetech_lotes_units_v31", JSON.stringify(datasetUnidades)); }catch(e){}
  }
  function restore(){
    try{
      const raw = localStorage.getItem("novetech_lotes_units_v31");
      if (raw){ datasetUnidades = JSON.parse(raw); return true; }
    }catch(e){}
    return false;
  }

  // ---------- Transformação & Filtro ----------
  function aggregateByCityFromUnits(units){
    const groups = new Map();
    for (const u of units){
      if (!u || !u.cidade) continue;
      const key = onlyCityName(u.cidade);
      if (!groups.has(key)) groups.set(key, []);
      groups.get(key).push(u);
    }
    const result = [];
    for (const [city, items] of groups){
      const importadoAtendente = items.reduce((a,b)=> a + (b.importadoAtendente||0), 0);
      const importadoPEC = items.reduce((a,b)=> a + (b.importadoPEC||0), 0);
      const invalidas = items.reduce((a,b)=> a + (b.invalidas||0), 0);
      const numeroPEC = modeOrMulti(items.map(i => i.numeroPEC));
      const versaoPEC = modeOrMulti(items.map(i => i.versaoPEC));
      const status = computeStatus({ importadoAtendente, importadoPEC, invalidas });
      result.push({ cidade: city, numeroPEC, versaoPEC, importadoAtendente, importadoPEC, invalidas, status, unidades: items });
    }
    return result;
  }

  function getFilteredUnits(){
    const q = normalize(dom.search.value);
    const cSel = dom.cidadeSel.value;
    const vSel = dom.versaoSel.value;
    const sSel = dom.statusSel.value;

    return datasetUnidades.filter(u => {
      const matchesQ = !q || normalize(u.cidade + " " + u.unidade + " " + u.numeroPEC + " " + u.versaoPEC).includes(q);
      const matchesC = !cSel || onlyCityName(u.cidade) === cSel;
      const matchesV = !vSel || u.versaoPEC === vSel;
      const st = computeStatus(u);
      const matchesS = !sSel || st === sSel;
      return matchesQ && matchesC && matchesV && matchesS;
    });
  }

  // ---------- UI Helpers ----------
  function sortBy(key){
    if (sortState.key === key){ sortState.dir = (sortState.dir === "asc" ? "desc" : "asc"); }
    else { sortState.key = key; sortState.dir = "asc"; }
    render();
  }
  function sortData(arr){
    const { key, dir } = sortState;
    const mul = dir === "asc" ? 1 : -1;
    arr.sort((a,b) => {
      const va = a[key], vb = b[key];
      const na = typeof va === "number", nb = typeof vb === "number";
      if (na && nb) return (va - vb) * mul;
      return String(va).localeCompare(String(vb), "pt-BR", { numeric: true }) * mul;
    });
  }
  function updateFiltersOptions(){
    // Preserva seleção atual ao repovoar as opções
    const prevCidade = dom.cidadeSel.value;
    const prevVersao = dom.versaoSel.value;

    const cidades = [...new Set(datasetUnidades.map(x => onlyCityName(x.cidade)))].sort((a,b) => a.localeCompare(b, "pt-BR"));
    const versoes = [...new Set(datasetUnidades.map(x => x.versaoPEC))].filter(Boolean).sort((a,b) => a.localeCompare(b, "pt-BR", { numeric: true }));

    dom.cidadeSel.innerHTML = '<option value="">Todas</option>' + cidades.map(c => `<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join("");
    dom.versaoSel.innerHTML = '<option value="">Todas</option>' + versoes.map(v => `<option value="${escapeHtml(v)}">${escapeHtml(v)}</option>`).join("");

    // Restaura seleção se ainda existir
    if ([...dom.cidadeSel.options].some(o => o.value === prevCidade)) dom.cidadeSel.value = prevCidade;
    if ([...dom.versaoSel.options].some(o => o.value === prevVersao)) dom.versaoSel.value = prevVersao;
  }

  function applyFilters(){
    const limit = parseInt(dom.limiteSel.value, 10) || 1000;
    const units = getFilteredUnits(); // <- recorte atual
    cidadesAgg = aggregateByCityFromUnits(datasetUnidades); // base completa
    const citiesAggFiltered = aggregateByCityFromUnits(units); // recorte para tabela

    const sSel = dom.statusSel.value;
    filtered = citiesAggFiltered.filter(r => !sSel || r.status === sSel);

    sortData(filtered);
    if (filtered.length > limit) filtered = filtered.slice(0, limit);

    return { units, citiesAggFiltered };
  }

  function highlightSortHeaders(){
    $$("#lotesTable thead th").forEach(th => {
      const key = th.getAttribute("data-key");
      const state = (key === sortState.key) ? sortState.dir : "none";
      th.setAttribute("aria-sort", state);
      th.style.color = (key === sortState.key) ? "#fff" : "var(--muted)";
    });
  }

  function unitRow(u){
    const st = computeStatus(u);
    const stCls = st === "OK" ? "ok" : (st === "Alerta" ? "alerta" : "critico");
    return `<tr>
      <td>${escapeHtml(u.unidade)}</td>
      <td class="mono nowrap">${escapeHtml(u.numeroPEC || "")}</td>
      <td class="nowrap">${escapeHtml(u.versaoPEC || "")}</td>
      <td class="right mono nowrap">${formatInt(u.importadoAtendente)}</td>
      <td class="right mono nowrap">${formatInt(u.importadoPEC)}</td>
      <td class="right mono nowrap">${formatInt(u.invalidas)}</td>
      <td><span class="status ${stCls}"><i class="dot"></i>${st}</span></td>
    </tr>`;
  }

  function renderTable(){
    if (!filtered.length){
      dom.tbody.innerHTML = `<tr><td colspan="7" style="text-align:center; color: var(--muted); padding: 28px">Nenhuma cidade para exibir.</td></tr>`;
      dom.footCount.textContent = "0";
      return;
    }
    const rows = [];
    for (const r of filtered){
      const cls = r.status === "OK" ? "ok" : (r.status === "Alerta" ? "alerta" : "critico");
      const isExpanded = expanded.has(r.cidade);
      rows.push(`<tr class="${isExpanded?'expanded':''}" data-row="cidade" data-cidade="${escapeHtml(r.cidade)}" tabindex="0" role="button" aria-expanded="${isExpanded?'true':'false'}">
        <td>
          <span class="row-toggle">
            <span class="caret" aria-hidden="true">▸</span>
            <strong>${escapeHtml(r.cidade)}</strong>
          </span>
        </td>
        <td class="mono nowrap">${escapeHtml(r.numeroPEC || "")}</td>
        <td class="nowrap">${escapeHtml(r.versaoPEC || "")}</td>
        <td class="right mono nowrap">${formatInt(r.importadoAtendente)}</td>
        <td class="right mono nowrap">${formatInt(r.importadoPEC)}</td>
        <td class="right mono nowrap">${formatInt(r.invalidas)}</td>
        <td><span class="status ${cls}"><i class="dot"></i>${r.status}</span></td>
      </tr>`);

      const unidades = (r.unidades || []).slice();
      const unitsHtml = unidades.length ? unidades.map(unitRow).join("") : `<tr><td colspan="7" style="text-align:center; color:var(--muted); padding:10px">Sem unidades para exibir.</td></tr>`;
      rows.push(`<tr class="details" data-details="${escapeHtml(r.cidade)}" style="${isExpanded?'':'display:none'}">
        <td colspan="7">
          <div class="units">
            <header>
              <div class="badge">Unidades em <strong>${escapeHtml(r.cidade)}</strong></div>
              <div class="badge">Total unidades: ${formatInt(unidades.length)}</div>
            </header>
            <table>
              <thead>
                <tr>
                  <th>Unidade</th>
                  <th class="nowrap">Nº do PEC</th>
                  <th>Versão PEC</th>
                  <th class="right nowrap">Importado p/ Atendente</th>
                  <th class="right nowrap">Importado p/ PEC</th>
                  <th class="right nowrap">Fichas inválidas</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                ${unitsHtml}
              </tbody>
            </table>
          </div>
        </td>
      </tr>`);
    }
    dom.tbody.innerHTML = rows.join("");
    dom.footCount.textContent = String(filtered.length);
  }

  function updateKpis(currentUnits){
    const units = currentUnits || datasetUnidades;
    const totalAt = units.reduce((a,b)=> a + (b.importadoAtendente||0), 0);
    const totalPec = units.reduce((a,b)=> a + (b.importadoPEC||0), 0);
    const totalInv = units.reduce((a,b)=> a + (b.invalidas||0), 0);
    const cidades = new Set(units.map(r => onlyCityName(r.cidade))).size;
    const unidades = units.length;
    const taxaInv = totalAt > 0 ? totalInv / totalAt : 0;
    dom.kpiCidades.textContent = (cidades||0).toLocaleString("pt-BR");
    dom.kpiUnidades.textContent = (unidades||0).toLocaleString("pt-BR");
    dom.kpiAtendente.textContent = (totalAt||0).toLocaleString("pt-BR");
    dom.kpiPec.textContent = (totalPec||0).toLocaleString("pt-BR");
    dom.kpiInvalidas.textContent = (totalInv||0).toLocaleString("pt-BR");
    dom.kpiTaxa.textContent = "Taxa inválidas: " + pct(taxaInv);
    const sucesso = totalAt > 0 ? totalPec / totalAt : 0;
    dom.progAt.style.width = "100%";
    dom.progPec.style.width = Math.max(0, Math.min(1, sucesso)) * 100 + "%";
  }

  function render(){
    updateFiltersOptions();                       // <- mantém seleção
    const { units } = applyFilters();             // <- recorte atual para tabela e KPIs
    updateKpis(units);
    renderTable();
    highlightSortHeaders();
    save();
  }

  function toast(msg){
    const t = document.createElement("div");
    t.textContent = msg;
    t.style.position = "fixed";
    t.style.left = "50%";
    t.style.bottom = "24px";
    t.style.transform = "translateX(-50%)";
    t.style.background = "rgba(20,165,255,.12)";
    t.style.border = "1px solid rgba(56,182,255,.35)";
    t.style.padding = "10px 14px";
    t.style.borderRadius = "999px";
    t.style.color = "var(--text)";
    t.style.fontWeight = "600";
    t.style.boxShadow = "var(--shadow-soft)";
    t.style.zIndex = "9999";
    document.body.appendChild(t);
    setTimeout(()=>{ t.style.opacity = "0"; t.style.transition = "opacity .5s"; }, 1800);
    setTimeout(()=> t.remove(), 2400);
  }

  function tickClock(){
    const now = new Date();
    const s = now.toLocaleString("pt-BR", { dateStyle: "medium", timeStyle: "short" });
    dom.clock.textContent = s;
  }

  // ---------- Importação / Exportação ----------
  function importCSV(text){
    const rows = parseCSV(text);
    if (!rows.length) return;
    const headerRaw = rows[0];
    const header = headerRaw.map(h => normalize(h));
    const map = {};
    const alias = {
      cidade: "cidade",
      unidade: "unidade",
      numerodopecatual: "numeroPEC", numerodpecatual: "numeroPEC",
      numerodopec: "numeroPEC", numeropec: "numeroPEC", numeropecatual: "numeroPEC", npec: "numeroPEC",
      versaoatualdopec: "versaoPEC", versaodopec: "versaoPEC", versaopec: "versaoPEC", versaopecatual: "versaoPEC",
      importadoparaatendentedesaude: "importadoAtendente", importadoatendente: "importadoAtendente",
      importadoatendentedesaude: "importadoAtendente", importadoatend: "importadoAtendente",
      importadoparaopec: "importadoPEC", importadopec: "importadoPEC",
      fichasinvalidas: "invalidas", invalidas: "invalidas", fichasnaovalidadas: "invalidas"
    };
    header.forEach((h, i) => {
      if (alias[h]) map[alias[h]] = i;
      else if (h === "cidade") map["cidade"] = i;
      else if (h === "unidade") map["unidade"] = i;
    });

    const hasUnidade = ("unidade" in map);

    const data = [];
    for (let r = 1; r < rows.length; r++){
      const row = rows[r];
      if (!row || !row.length) continue;
      if (hasUnidade){
        const item = {
          cidade: onlyCityName(String(row[map.cidade] || "").trim()),
          unidade: String(row[map.unidade] || "").trim(),
          numeroPEC: String(row[map.numeroPEC] || "").trim(),
          versaoPEC: String(row[map.versaoPEC] || "").trim(),
          importadoAtendente: toInt(row[map.importadoAtendente]),
          importadoPEC: toInt(row[map.importadoPEC]),
          invalidas: toInt(row[map.invalidas])
        };
        if (item.cidade && item.unidade) data.push(item);
      } else {
        const item = {
          cidade: onlyCityName(String(row[map.cidade] || "").trim()),
          unidade: "Geral",
          numeroPEC: String(row[map.numeroPEC] || "").trim(),
          versaoPEC: String(row[map.versaoPEC] || "").trim(),
          importadoAtendente: toInt(row[map.importadoAtendente]),
          importadoPEC: toInt(row[map.importadoPEC]),
          invalidas: toInt(row[map.invalidas])
        };
        if (item.cidade) data.push(item);
      }
    }

    if (!data.length){
      alert("Nenhuma linha válida encontrada no CSV.");
      return;
    }
    datasetUnidades = data;
    expanded.clear();
    render();
    toast("CSV importado com sucesso (" + data.length + " linhas).");
  }

  function exportCSV(){
    const hasRealUnits = datasetUnidades.some(u => (u.unidade || "").toLowerCase() !== "geral");
    if (hasRealUnits){
      const header = "cidade,unidade,numero_pec_atual,versao_pec_atual,importado_atendente,importado_pec,fichas_invalidas\n";
      const lines = datasetUnidades.map(r => [
        r.cidade, r.unidade, r.numeroPEC, r.versaoPEC, r.importadoAtendente, r.importadoPEC, r.invalidas
      ].map(v => {
        const s = (v ?? "").toString();
        return (s.includes(",") || s.includes(";") || s.includes('"')) ? '"' + s.replace(/"/g,'""') + '"' : s;
      }).join(","));
      downloadCsv(header + lines.join("\n"), "novetech-lotes-unidades.csv");
    } else {
      const agg = aggregateByCityFromUnits(datasetUnidades);
      const header = "cidade,numero_pec_atual,versao_pec_atual,importado_atendente,importado_pec,fichas_invalidas\n";
      const lines = agg.map(r => [
        r.cidade, r.numeroPEC, r.versaoPEC, r.importadoAtendente, r.importadoPEC, r.invalidas
      ].map(v => {
        const s = (v ?? "").toString();
        return (s.includes(",") || s.includes(";") || s.includes('"')) ? '"' + s.replace(/"/g,'""') + '"' : s;
      }).join(","));
      downloadCsv(header + lines.join("\n"), "novetech-lotes-cidades.csv");
    }
  }
  function downloadCsv(csv, filename){
    const blob = new Blob([csv], { type: "text/csv;charset=utf-8" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
  }

  // ---------- Eventos ----------
  $("#lotesTable thead").addEventListener("click", (e) => {
    const th = e.target.closest("th");
    if (!th) return;
    const key = th.getAttribute("data-key");
    if (!key) return;
    sortBy(key);
  });

  dom.search.addEventListener("input", render);
  dom.cidadeSel.addEventListener("change", () => { expanded.clear(); render(); });
  dom.versaoSel.addEventListener("change", () => { expanded.clear(); render(); });
  dom.statusSel.addEventListener("change", () => { expanded.clear(); render(); });
  dom.limiteSel.addEventListener("change", render);
  dom.exportCsvBtn.addEventListener("click", exportCSV);
  dom.resetBtn.addEventListener("click", () => {
    loadExampleUnits();
    expanded.clear();
    render();
    toast("Dados de exemplo por unidades restaurados.");
  });

  $("#lotesTable tbody").addEventListener("click", (e) => {
    const row = e.target.closest('tr[data-row="cidade"]');
    if (!row) return;
    const city = row.getAttribute("data-cidade");
    toggleExpand(city);
  });
  $("#lotesTable tbody").addEventListener("keydown", (e) => {
    if (e.key === "Enter" || e.key === " "){
      const row = e.target.closest('tr[data-row="cidade"]');
      if (!row) return;
      e.preventDefault();
      const city = row.getAttribute("data-cidade");
      toggleExpand(city);
    }
  });

  function toggleExpand(city){
    if (expanded.has(city)) expanded.delete(city);
    else expanded.add(city);
    const isExp = expanded.has(city);
    const tr = $(`#lotesTable tbody tr[data-row="cidade"][data-cidade="${cssEscape(city)}"]`);
    const details = $(`#lotesTable tbody tr.details[data-details="${cssEscape(city)}"]`);
    if (tr){ tr.classList.toggle("expanded", isExp); tr.setAttribute("aria-expanded", isExp ? "true" : "false"); }
    if (details){ details.style.display = isExp ? "" : "none"; }
  }

  function cssEscape(s){
    return (s || "").toString().replace(/["\\]/g, "\\$&");
  }

  // ---------- Init ----------
  function init(){
    if (!restore()) loadExampleUnits();
    render();
    setInterval(tickClock, 1000); tickClock();
  }

  dom.file.addEventListener("change", async (e) => {
    const file = e.target.files && e.target.files[0];
    if (!file) return;
    const text = await file.text();
    importCSV(text);
    e.target.value = "";
  });

  init();
})();
</script>
</body>
</html>
